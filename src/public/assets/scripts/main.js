angular.module("dias.export",["dias.api","dias.ui"]),angular.module("dias.export").config(["$compileProvider",function(t){"use strict";t.debugInfoEnabled(!1)}]),angular.module("dias.export").controller("ProjectReportRequestController",["$scope","ProjectReport","ReportForm","PROJECT_ID",function(t,e,a,s){"use strict";var r={annotations:["basic","extended","area","full","csv"],"image-labels":["basic","csv"]},n={annotations:["exportArea","separateLabelTrees"],"image-labels":["separateLabelTrees"]},o={type:"annotations",variant:"basic",options:{exportArea:!1,separateLabelTrees:!1}};t.form=new a(r,n,o),t.submit=function(){t.form.submit(e,{project_id:s})}}]),angular.module("dias.export").controller("TransectReportRequestController",["$scope","TransectReport","ReportForm","TRANSECT_ID",function(t,e,a,s){"use strict";var r={annotations:["basic","extended","area","full","csv"],"image-labels":["basic","csv"]},n={annotations:["exportArea","separateLabelTrees","annotationSession"],"image-labels":["separateLabelTrees","annotationSession"]},o={type:"annotations",variant:"basic",options:{exportArea:!1,separateLabelTrees:!1,annotationSession:null}};t.form=new a(r,n,o),t.submit=function(){t.form.submit(e,{transect_id:s})}}]),angular.module("dias.export").factory("ProjectReport",["$resource","URL",function(t,e){"use strict";return t(e+"/api/v1/projects/:project_id/reports/:type/:variant",{},{requestGenericReport:{method:"POST"},requestBasicAnnotationReport:{method:"POST",params:{type:"annotations",variant:"basic"}},requestExtendedAnnotationReport:{method:"POST",params:{type:"annotations",variant:"extended"}},requestFullAnnotationReport:{method:"POST",params:{type:"annotations",variant:"full"}},requestCsvAnnotationReport:{method:"POST",params:{type:"annotations",variant:"csv"}},requestAnnotationAreaReport:{method:"POST",params:{type:"annotations",variant:"area"}},requestBasicImageLabelReport:{method:"POST",params:{type:"image-labels",variant:"basic"}},requestCsvImageLabelReport:{method:"POST",params:{type:"image-labels",variant:"csv"}}})}]),angular.module("dias.export").factory("ReportForm",["msg",function(t){"use strict";function e(t,e,a){this.variants=t,this.allowedOptions=e,this.defaultForm=a,this.data=angular.copy(this.defaultForm),this.state={success:!1,loading:!1},this.availableVariants=this.variants[this.data.type]}return e.prototype.handleRequestSuccess=function(){this.state.success=!0,this.state.loading=!1,this.error={}},e.prototype.handleRequestError=function(e){this.state.loading=!1,this.success=!1,422===e.status?this.error=e.data:t.responseError(e)},e.prototype.selectType=function(t){this.data.type=t,this.availableVariants=this.variants[t],this.data.variant=this.availableVariants[0]},e.prototype.wantsType=function(t){return this.data.type===t},e.prototype.wantsCombination=function(t,e){return this.wantsType(t)&&this.data.variant===e},e.prototype.submit=function(t,e){for(var a=this,s={},r=this.allowedOptions[this.data.type],n=r.length-1;n>=0;n--)s[r[n]]=this.data.options[r[n]];this.state.loading=!0,this.state.success=!1,e=angular.extend(e,{type:this.data.type,variant:this.data.variant}),t.requestGenericReport(e,s,function(){a.handleRequestSuccess()},function(t){a.handleRequestError(t)})},e}]),angular.module("dias.export").factory("TransectReport",["$resource","URL",function(t,e){"use strict";return t(e+"/api/v1/transects/:transect_id/reports/:type/:variant",{},{requestGenericReport:{method:"POST"},requestBasicAnnotationReport:{method:"POST",params:{type:"annotations",variant:"basic"}},requestExtendedAnnotationReport:{method:"POST",params:{type:"annotations",variant:"extended"}},requestFullAnnotationReport:{method:"POST",params:{type:"annotations",variant:"full"}},requestCsvAnnotationReport:{method:"POST",params:{type:"annotations",variant:"csv"}},requestAnnotationAreaReport:{method:"POST",params:{type:"annotations",variant:"area"}},requestBasicImageLabelReport:{method:"POST",params:{type:"image-labels",variant:"basic"}},requestCsvImageLabelReport:{method:"POST",params:{type:"image-labels",variant:"csv"}}})}]);